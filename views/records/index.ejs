<%- include('../partials/html-head') %>
<%- include('../partials/nav') %>

<div class="container">
  <p><center><h3 class="text-white">Can't find something?  <a href="/records/new" class="link-info">Add it to our database!</a></h3></center></p>
</div>



<div class="container bg-dark" id="formdiv">
  <table class="table table-striped table-dark" id="list">
    <thead>
      <tr>
        <th scope="col">Artist</th>
        <th scope="col">Title</th>
        <th scope="col">Released</th>
        <th scope="col">Label</th>
        <th scope="col">Genre</th>
        <th scope="col">Reviews</th>
        <th scope="col">Collect</th>
        <th scope="col">Wishlist</th>
      </tr>
    </thead>
    <tbody>
    <% records.forEach((record) => { %>
      <tr>
        <td>
          <form action="/records/artistClickSearch" method="POST" class="d-flex mx-4">
            <input class="remove_button_css btn-link link-info" type="submit" name="artist" value="<%= record.artist %>">
          </form>
        </td>
        <td>
          <a href="/records/<%= record._id %>">
            <button class="remove_button_css btn-link link-info">
              <%= record.title %>
            </button>
          </a>
        </td>
        <td>
          <form action="/records/yearClickSearch" method="POST" class="d-flex mx-4">
            <input class="remove_button_css btn-link link-info" type="submit" name="originalYear" value="<%= record.originalYear %>">
          </form>
        </td>
        <td>
          <form action="/records/labelClickSearch" method="POST" class="d-flex mx-4">
            <input type="submit" class="remove_button_css btn-link link-info" name="label" value="<%= record.label %>">
          </form>
        </td>
        <td>
          <form action="/records/genreClickSearch" method="POST" class="d-flex mx-4">
            <input type="submit" class="remove_button_css btn-link link-info" name="genre" value="<%= record.genre %>">
          </form>
        </td>
        <td>
          <button class="remove_button_css btn-link">
            <a href="/records/<%= record._id %>" class="link-info">
              <%= record.reviews.length %>
            </a>
          </button>
        </td>
        <td>
          <form class="" action="/records/<%= record._id %>/addToCollection" method="POST" name="recordId">
            <button>Collect</button><br>
          </form>
        </td>
        <td>               
          <form class="" action="/records/<%= record._id %>/addToWishlist" method="POST" name="recordId">

            <!-- if logged in user's profile -a referenced profile model- has an object in their property "shelf" array, the button is disabled or removed.  if that shelf property of model doesn't not hold a matching object, the button is enabled. -->
            <!-- i am trying to get .includes to return a boolean value of whether or not a record._id is in the profile.shelf array.  if true, button disabled.  if false, button emabled. -->

            <% if (user.profile.shelf.includes(record._id)) { %>
              <button disabled>Wishlist</button><br>
            <% } else { %>
              <button>Wishlist</button><br>
            <% } %>

          </form>
        </td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<%- include('../partials/footer') %>